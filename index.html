<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Pomodoro Mini — Notion Safe</title>
<style>
  /* Safe reset so Notion CSS can't break layout */
  *, *::before, *::after { box-sizing: border-box; }
  html, body { height: 100%; margin: 0; padding: 0; }
  body{
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
    background: transparent !important;   /* <-- stay transparent inside Notion */
    color:#111317; display:flex; align-items:center; justify-content:center;
  }

  :root{
    --diam: 300px;       /* overall square size */
    --ring: 0.04;        /* ring thickness (0.02–0.10) */
    --fs: 0.22;          /* time font scale (0.16–0.30) */
    /* Light theme defaults (safer for Notion embeds) */
    --accent:#7c3aed; --text:#111317; --muted:#67707a; --track: rgba(17,19,23,.15);
  }
  /* Optional dark theme (enable via ?theme=dark) */
  .dark {
    --text:#e6e7ea; --muted:#9aa1aa; --track: rgba(255,255,255,.15);
  }

  .shell{ width: var(--diam); height: var(--diam); position: relative; margin: 0 auto; }

  /* Dial area leaves space at bottom for buttons (kept inside 300x300) */
  .dial{ position:absolute; inset:0; padding: 8px 8px 54px 8px; }
  .ring{ width:100%; height:100%; position:relative; cursor:pointer; }
  .ring svg{ width:100%; height:100%; display:block; transform: rotate(-90deg); }

  .label{
    position:absolute; inset:0; display:grid; place-items:center;
    text-align:center; pointer-events:none; padding: 10%;
  }
  .big{
    margin:0; line-height:1; font-variant-numeric: tabular-nums;
    font-weight:800; letter-spacing:.5px; color:var(--text);
    font-size: clamp(18px, calc(var(--diam) * var(--fs)), 64px);
  }
  .sub{ margin-top:6px; color:var(--muted); font-size: clamp(10px, calc(var(--diam) * 0.06), 14px); }

  .controls{
    position:absolute; left:0; right:0; bottom:8px;
    display:flex; gap:6px; justify-content:center; align-items:center; padding:0 8px;
  }
  .btn{ border:none; border-radius:10px; padding:8px 10px; font-weight:700; font-size:12px; cursor:pointer; }
  .primary{ background:var(--accent); color:#fff; }
  .ghost{ background:rgba(0,0,0,.06); color:var(--text); }
  .danger{ background:#ef4444; color:#fff; }
</style>
</head>
<body>
  <div class="shell" id="root">
    <div class="dial">
      <div class="ring" id="dial" aria-label="Timer dial (click to start/pause; double-click to reset)">
        <svg viewBox="0 0 120 120" aria-hidden="true">
          <circle id="track" cx="60" cy="60" r="54" stroke="var(--track)" fill="none" />
          <circle id="arc"   cx="60" cy="60" r="54" stroke="var(--accent)" fill="none" stroke-linecap="round"/>
        </svg>
        <div class="label">
          <div class="big" id="time">25:00</div>
          <div class="sub" id="subtext">Cycle 1/4</div>
        </div>
      </div>
    </div>

    <div class="controls">
      <button class="btn primary" id="toggle">Start</button>
      <button class="btn ghost"   id="skip">Skip</button>
      <button class="btn danger"  id="reset">Reset</button>
    </div>
  </div>

<script>
(function(){
  const qs = new URLSearchParams(location.search);
  const cfg = {
    work: +qs.get('work') || 25,
    short: +qs.get('short') || 5,
    long: +qs.get('long') || 15,
    cycles: +qs.get('cycles') || 4,
    auto: qs.get('auto') !== '0',
    sound: qs.get('sound') !== '0',
    theme: (qs.get('theme') || 'light').toLowerCase(),   // default LIGHT for embeds
    size: Math.max(220, Math.min(600, +(qs.get('size')||0) || 300)),
    ringPct: Math.min(0.10, Math.max(0.02, +(qs.get('ring')||0) || 0.04)),
    fs: Math.min(0.30, Math.max(0.16, +(qs.get('fs')||0) || 0.22)),
  };

  // Force transparent background in embeds & set theme class
  document.body.style.background = 'transparent';
  if (cfg.theme === 'dark
